# üö® Corner Cases –∏ Edge Cases - –ê–Ω–∞–ª–∏–∑

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ö–∞–Ω–∞–ª —É–¥–∞–ª–µ–Ω / –í–∏–¥–µ–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –∫–∞–Ω–∞–ª–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –í Redis –µ—Å—Ç—å `message_id`, –Ω–æ –≤ Telegram –∫–∞–Ω–∞–ª–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ `copy_message` –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É `BadRequest: message not found`

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –ï—Å—Ç—å –æ–±—â–∏–π `except Exception`, –Ω–æ –Ω–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–µ—Ä–µ—Å–∫–∞—á–∏–≤–∞–µ–º (—Å—Ç—Ä–æ–∫–∞ 436-442), –Ω–æ –Ω–µ —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—É—é –∑–∞–ø–∏—Å—å –∏–∑ –∫—ç—à–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –æ—à–∏–±–∫—É Telegram API (`BadRequest` —Å —Ç–µ–∫—Å—Ç–æ–º "message not found")
- –£–¥–∞–ª—è—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—É—é –∑–∞–ø–∏—Å—å –∏–∑ Redis –∫—ç—à–∞
- –ü–µ—Ä–µ—Å–∫–∞—á–∏–≤–∞—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç

---

### 2. ‚ùå Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- Redis —É–ø–∞–ª –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –ë–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à, –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –ù–µ—Ç —è–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:
- Try-catch –ø—Ä–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å Redis
- Fallback: —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∫—ç—à–∞ (—Å–∫–∞—á–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

### 3. ‚ùå PostgreSQL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- PostgreSQL —É–ø–∞–ª
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –°–æ–±—ã—Ç–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥–∏ Redis
- `analytics_worker` –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏, –Ω–æ –Ω–µ –ø–∞–¥–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –°–æ–±—ã—Ç–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
- Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ gracefully

---

### 4. ‚ùå Worker —É–ø–∞–ª / –Ω–µ –∑–∞–ø—É—â–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- Worker –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏
- –ó–∞–¥–∞—á–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥–µ—Ç timeout (30 –º–∏–Ω—É—Ç)

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- Timeout 30 –º–∏–Ω—É—Ç, –∑–∞—Ç–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- Timeout —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å: –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π timeout (5-10 –º–∏–Ω—É—Ç) –¥–ª—è –ª—É—á—à–µ–≥–æ UX

---

### 5. ‚ùå –í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –¥–ª—è Telegram
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- Telegram –ª–∏–º–∏—Ç: 50MB –¥–ª—è –≤–∏–¥–µ–æ
- –í–∏–¥–µ–æ –±–æ–ª—å—à–µ 50MB –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –û–±—â–∞—è –æ—à–∏–±–∫–∞ "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π"

**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–∂–∞—Ç—å –∏–ª–∏ –æ–±—Ä–µ–∑–∞—Ç—å

---

### 6. ‚ùå –í–∏–¥–µ–æ —É–¥–∞–ª–µ–Ω–æ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- YouTube/Instagram/TikTok —É–¥–∞–ª–∏–ª–∏ –≤–∏–¥–µ–æ
- `yt-dlp` –Ω–µ –º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- `downloader.download_video()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None`
- Worker –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ `failed`

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å: –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

### 7. ‚ùå –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- yt-dlp —Ç–∞–π–º–∞—É—Ç
- Telegram API —Ç–∞–π–º–∞—É—Ç

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- Timeout 30 –º–∏–Ω—É—Ç –¥–ª—è worker
- Timeout 600 —Å–µ–∫—É–Ω–¥ –¥–ª—è Telegram API

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å: –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∏–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

---

### 8. ‚ùå Race conditions –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –î–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ–¥–Ω–æ –≤–∏–¥–µ–æ
- –û–±–∞ –ø–æ–ª—É—á–∞—é—Ç lock –∏–ª–∏ –æ–±–∞ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- Redis lock –º–µ—Ö–∞–Ω–∏–∑–º (`acquire_download_lock`)
- –û–¥–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç lock, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 9. ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ URL
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ URL
- URL –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- URL –±–∏—Ç—ã–π (404)

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `is_supported_url()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ URL

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å: –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

---

### 10. ‚ùå Rate limits Telegram API
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram API
- –ü–æ–ª—É—á–∞–µ–º `429 Too Many Requests`

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –ù–µ—Ç —è–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–†–µ—à–µ–Ω–∏–µ**: 
- Retry —Å exponential backoff
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å rate limit –æ—à–∏–±–∫–∏
- –û—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

### 11. ‚ùå file_id –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π (–¥–ª—è inline query)
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –í Redis –µ—Å—Ç—å `file_id`, –Ω–æ –æ–Ω —É—Å—Ç–∞—Ä–µ–ª
- Telegram –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –¥–ª—è `InlineQueryResultCachedVideo`

**–†–µ—à–µ–Ω–∏–µ**: 
- Fallback: –µ—Å–ª–∏ `file_id` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å deep link –≤–º–µ—Å—Ç–æ cached video
- –û–±–Ω–æ–≤–ª—è—Ç—å `file_id` –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

### 12. ‚ùå –ö–∞–Ω–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω / –±–æ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∫–∞–Ω–∞–ª–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ë–æ—Ç –±–æ–ª—å—à–µ –Ω–µ –∞–¥–º–∏–Ω –∫–∞–Ω–∞–ª–∞
- –ù–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ –≤ –∫–∞–Ω–∞–ª

**–¢–µ–∫—É—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: 
- –û–±—â–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ `send_video` –≤ –∫–∞–Ω–∞–ª

**–†–µ—à–µ–Ω–∏–µ**: 
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–¥–º–∏–Ω—É –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (–≤–ª–∏—è–µ—Ç –Ω–∞ UX):
1. ‚úÖ **–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π message_id** - —É–¥–∞–ª—è—Ç—å –∏–∑ –∫—ç—à–∞ –∏ –ø–µ—Ä–µ—Å–∫–∞—á–∏–≤–∞—Ç—å **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
2. ‚úÖ **Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** - fallback —Ä–µ–∂–∏–º **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
3. ‚ö†Ô∏è **file_id –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π** - fallback –Ω–∞ deep link (—á–∞—Å—Ç–∏—á–Ω–æ, Telegram –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### üü° –í–∞–∂–Ω–æ (—É–ª—É—á—à–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å):
4. **Rate limits** - retry –º–µ—Ö–∞–Ω–∏–∑–º (TODO)
5. **–í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ (TODO)
6. **–ö–∞–Ω–∞–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (TODO)

### üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ (nice to have):
7. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ (TODO)
8. **–ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –æ–± –æ—à–∏–±–∫–∞—Ö (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
9. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ (TODO)

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ message_id
**–ì–¥–µ**: `bot.py` - –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `copy_message`

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `TelegramBadRequest` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π "message not found"
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏–∑ Redis –∫—ç—à–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞

**–ú–µ—Å—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è**:
- `handle_message()` - –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏–∑ –∫—ç—à–∞
- `download_and_send()` - –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ—Å–ª–µ worker'–∞
- `callback_resend_handler()` - –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Redis
**–ì–¥–µ**: `bot.py` - `download_and_send()`

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- Try-catch –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫—ç—à–∞
- Try-catch –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ª–∏–º–∏—Ç–æ–≤
- Try-catch –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ**:
- –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫—ç—à–∞ ‚Üí —Ä–∞–±–æ—Ç–∞–µ–º –±–µ–∑ –∫—ç—à–∞ (—Å–∫–∞—á–∏–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ä–∞–∑)
- –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ª–∏–º–∏—Ç–∞ ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É
- –ï—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ ‚Üí —Å–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± –æ—à–∏–±–∫–µ

### 3. –ú–µ—Ç–æ–¥ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫—ç—à–∞
**–ì–¥–µ**: `database.py` - `delete_from_cache()`

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ**:
- –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∏–∑ –∫—ç—à–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ `video_id` –∏–ª–∏ `url`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –æ—à–∏–±–æ–∫ "message not found"
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–Ω–∞–ª–∞**: –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª—É
3. **Retry –º–µ—Ö–∞–Ω–∏–∑–º**: –î–ª—è rate limits –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ Telegram API
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞**: –ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ Telegram –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–º–µ—Ä
5. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –¥–æ–ª–≥–æ–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏
